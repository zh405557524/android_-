# 大厂面试题



## 一、JVM相关

### 1、Android 平台是基于栈的吗？

* 1、相关知识点。

  * 栈帧：JVM 内存模型中堆、栈、方法区、本地方法栈、程序计数器

    * 上面内存模型的栈中，当方法执行的时候，就是一个栈帧，这个栈帧中会有局部变量表、操作数栈、方法出口。上面所述的栈指的是这里的操作栈。JVM是基于栈的，android的虚机机DVM和ART都不是基于栈的。

  * JVM虚拟机的栈帧

    * 局部变量表

      > 记录方法中，所有变量的值

    * 操作数栈

      > 根据字节码来运算或者赋值将数值放入操作数栈，一般就两个容量。

    * 方法出口

    * 程序计数器

      > 记录当前代码运行在字节码中的哪一行

  *  DVM 虚拟机的栈帧

    * 虚拟寄存器

      > 插槽的数量根据变量的个数来确定
      >
      > 然后根据字节码来运算或者赋值来决定插槽的值

* 2、如何看待j基于栈的虚拟设计与Android平台基于寄存器的设计

* 1、基于栈的虚拟设计

  > 基于栈的虚拟机，可移植性高。
  >
  > * 为了提高效率，虚拟寄存器要映射到真是机器的寄存器，增加了移植难度
  > * 操作栈的指令是通用的。

  > 更快，更省内存
  >
  > * 指令条数少
  > * 数据移动次数少，临时结果存放次数少
  > * 映射真是机器的寄存器
  > * Android 不需要解决移植性问题

### 2、为什么dex文件比class文件更适合移动端

* 1、class文件

  * 1、每个类对应一个class文件，会有很多个class文件。
  * 2、每一个类里面有:文件头、常量池、类信息、字段表、方法表、属性表

* 2、dex文件

  * dex一般就1个，或者多个，不会像class文件会有很多个。
  * dex里面有:
    * 1、文件头
    * 2、string_ids、type_ids、prote_ids、field_ids、method_ids。索引区
    * 3、类定义、数据。数据区

* 3、dex文件的优点

  * 1、减少文件，只有1个或者多个dex文件，不会出现很多个class文件。减少io操作和解析操作，能节省电量。
  * 2、合并冗余的常量，在一个文件中，会讲相同的常量合并。减少apk体积大小 节约内存。
  * 3、class基于栈、dex基于虚拟寄存器的字节码。减少运行内存，节约内存

  

  





























